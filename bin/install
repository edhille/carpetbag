#! /bin/bash

# workaround for systems that have poor cert support
# from SO http://stackoverflow.com/questions/6414232/curl-certificate-error-when-using-rvm-to-install-ruby-1-9-2
curl http://curl.haxx.se/ca/cacert.pem -o cacert.pem
export CURL_CA_BUNDLE=~/.carpetbag/cacert.pem

# from SO http://stackoverflow.com/questions/3777075/ssl-certificate-rejected-trying-to-access-github-over-https-behind-firewall
export GIT_SSL_CAINFO=~/.carpetbag/cacert.pem

# update our submodules if we have not set them up yet on this machine
if [  $(ls -l ~/.carpetbag/configs/bash-git-prompt | wc -l) = 0 ]; then
	git submodule init
	git submodule update
fi

echo "Run installers..."
for file in ~/.carpetbag/install.d/*; do $file; done

echo "Link config files..."
~/.carpetbag/bin/link-cfgs

export CURL_CA_BUNDLE=
export GIT_SSL_CAINFO=
